(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56654,e=>{"use strict";let a=(0,e.i(78773).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>a],56654)},57826,e=>{"use strict";var a=e.i(77678),s=e.i(78460),t=e.i(11300),r=e.i(2863),l=e.i(19744);function n({className:e,type:s,...t}){return(0,a.jsx)("input",{type:s,"data-slot":"input",className:(0,l.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...t})}var o=e.i(56654),d=e.i(69951),i=e.i(78773);let c=(0,i.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),m=(0,i.default)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);function x({className:e,...s}){return(0,a.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,a.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",e),...s})})}function u({className:e,...s}){return(0,a.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",e),...s})}function h({className:e,...s}){return(0,a.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",e),...s})}function b({className:e,...s}){return(0,a.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function g({className:e,...s}){return(0,a.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function p({className:e,...s}){return(0,a.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function f({data:l,onShowCharts:i}){let[f,j]=(0,s.useState)(""),[v,N]=(0,s.useState)(null),[k,w]=(0,s.useState)("asc"),[y,C]=(0,s.useState)(!1),B=[...l.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(f.toLowerCase())))].sort((e,a)=>{if(!v)return 0;let s=e[v],t=a[v],r="asc"===k?1:-1;return s>t?r:-r}),S=e=>{v===e?w("asc"===k?"desc":"asc"):(N(e),w("asc"))},A=async()=>{if(l&&0!==l.length)try{C(!0);let a=await e.A(94535),s=a.utils.json_to_sheet(l),t=a.utils.book_new();a.utils.book_append_sheet(t,s,"Resultado"),a.writeFile(t,"mesclagem_resultado.xlsx")}catch(e){console.error("Erro ao gerar Excel",e),alert("Falha ao gerar arquivo Excel. Veja o console para detalhes.")}finally{C(!1)}};return(0,a.jsx)("section",{className:"bg-background border-b",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-12 md:py-16",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold mb-2",children:"Resultado da Mesclagem"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[B.length," registros encontrados"]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(r.Button,{variant:"outline",onClick:A,className:"gap-2 hover:bg-primary hover:text-primary-foreground transition-colors",disabled:y,children:[(0,a.jsx)(o.Download,{className:"w-4 h-4"}),y?"Gerando...":"Download Excel"]}),(0,a.jsxs)(r.Button,{onClick:i,className:"gap-2",children:[(0,a.jsx)(d.BarChart3,{className:"w-4 h-4"}),"Gerar Gráficos"]})]})]}),(0,a.jsxs)(t.Card,{className:"mb-6 shadow-sm",children:[(0,a.jsx)("div",{className:"p-4 border-b bg-muted/30",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(n,{placeholder:"Pesquisar por vendedor, data, status...",value:f,onChange:e=>j(e.target.value),className:"pl-10"})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(x,{children:[(0,a.jsx)(u,{children:(0,a.jsxs)(b,{className:"bg-muted/50",children:[(0,a.jsx)(g,{children:(0,a.jsxs)(r.Button,{variant:"ghost",size:"sm",className:"gap-1 -ml-3 font-semibold",onClick:()=>S("id"),children:["ID",(0,a.jsx)(m,{className:"w-3 h-3"})]})}),(0,a.jsx)(g,{children:(0,a.jsxs)(r.Button,{variant:"ghost",size:"sm",className:"gap-1 -ml-3 font-semibold",onClick:()=>S("vendedor"),children:["Vendedor",(0,a.jsx)(m,{className:"w-3 h-3"})]})}),(0,a.jsx)(g,{children:(0,a.jsxs)(r.Button,{variant:"ghost",size:"sm",className:"gap-1 -ml-3 font-semibold",onClick:()=>S("data"),children:["Data",(0,a.jsx)(m,{className:"w-3 h-3"})]})}),(0,a.jsx)(g,{children:(0,a.jsxs)(r.Button,{variant:"ghost",size:"sm",className:"gap-1 -ml-3 font-semibold",onClick:()=>S("status"),children:["Status SLA",(0,a.jsx)(m,{className:"w-3 h-3"})]})}),(0,a.jsx)(g,{children:(0,a.jsxs)(r.Button,{variant:"ghost",size:"sm",className:"gap-1 -ml-3 font-semibold",onClick:()=>S("dias"),children:["Dias Atraso",(0,a.jsx)(m,{className:"w-3 h-3"})]})})]})}),(0,a.jsx)(h,{children:B.map(e=>(0,a.jsxs)(b,{className:"hover:bg-muted/30 transition-colors",children:[(0,a.jsx)(p,{className:"font-medium",children:e.id}),(0,a.jsx)(p,{className:"font-medium",children:e.vendedor}),(0,a.jsx)(p,{children:e.data}),(0,a.jsx)(p,{children:(0,a.jsx)("span",{className:`inline-flex items-center px-2.5 py-1 rounded-md text-xs font-semibold ${(e=>{switch(e){case"Atrasado":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400 border border-red-200 dark:border-red-800";case"No Prazo":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400 border border-green-200 dark:border-green-800";case"Atenção":return"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-400 border border-amber-200 dark:border-amber-800";default:return"bg-muted text-muted-foreground"}})(e.status)}`,children:e.status})}),(0,a.jsx)(p,{children:e.dias>0?(0,a.jsxs)("span",{className:`font-bold ${e.dias>=5?"text-red-600 dark:text-red-400":e.dias>=3?"text-orange-600 dark:text-orange-400":"text-amber-600 dark:text-amber-400"}`,children:[e.dias," dias"]}):(0,a.jsx)("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"No prazo"})})]},e.id))})]})})]})]})})})}e.s(["ResultsSection",()=>f],57826)},2200,e=>{e.n(e.i(57826))},94535,e=>{e.v(a=>Promise.all(["static/chunks/e4ce4a1366c4759f.js","static/chunks/66636cb3b4e74a90.js"].map(a=>e.l(a))).then(()=>a(77261)))}]);